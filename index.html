<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Interactive Synthesizer</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet" />

  <style>
    :root {
      --bg-primary: #0b0f1a;
      --bg-secondary: #131b2c;
      --bg-tertiary: #1c273a;
      --accent-color: #00f0ff;
      --accent-hover: #ff00cc;
      --text-primary: #ffffff;
      --text-secondary: #9bb8d3;
      --border-color: #2c3e50;

      --radius-small: 6px;
      --radius-medium: 12px;
      --radius-large: 16px;
      --radius-control: 50%;

      --spacing-sm: 8px;
      --spacing-md: 16px;
      --spacing-lg: 24px;

      --font-main: 'Orbitron', sans-serif;
    }

    body.light-theme {
      --bg-primary: #f2f2f7;
      --bg-secondary: #ffffff;
      --bg-tertiary: #e9ecf3;
      --accent-color: #007bff;
      --accent-hover: #0056b3;
      --text-primary: #1a1a1a;
      --text-secondary: #555;
      --border-color: #ccc;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-main);
      background: var(--bg-primary);
      color: var(--text-primary);
      padding: var(--spacing-lg);
      min-height: 100vh;
      transition: background 0.3s, color 0.3s;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    h1 {
      text-align: center;
      font-size: 3rem;
      font-weight: 700;
      letter-spacing: 2px;
      background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
      margin-bottom: var(--spacing-sm);
      text-transform: uppercase;
    }

    .subtitle {
      text-align: center;
      color: var(--text-secondary);
      margin-bottom: var(--spacing-lg);
    }

    .theme-toggle {
      text-align: center;
      margin-bottom: 16px;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    .theme-toggle input {
      transform: scale(1.2);
      margin-right: 8px;
    }

    /* Your full CSS continues here... (sliders, knobs, keyboard, etc.) */
    /* To save space, I‚Äôll continue in the next part with all HTML sections and JS */

  </style>
</head>
<body>
  <div class="container">
    <h1>Interactive Synthesizer</h1>
    
    <!-- üåó Theme Toggle -->
    <div class="theme-toggle">
      <label>
        <input type="checkbox" id="theme-toggle" />
        Enable Light Theme
      </label>
    </div>

    <p class="subtitle">Explore the fundamentals of synthesis and sound design</p>

    <!-- üéõÔ∏è Your full synth UI begins here -->
    <div class="synth-container">
      <!-- Oscillator Section -->
      <div class="section">
        <h2>üåä Oscillator</h2>
        <p class="info-text">The oscillator generates the basic sound wave. Different waveforms create different tonal characteristics.</p>
        <div class="waveform-select">
          <button class="wave-btn active" data-wave="sine">Sine</button>
          <button class="wave-btn" data-wave="square">Square</button>
          <button class="wave-btn" data-wave="sawtooth">Sawtooth</button>
          <button class="wave-btn" data-wave="triangle">Triangle</button>
        </div>
      </div>

      <!-- Filter Section -->
      <div class="section">
        <h2>üéõÔ∏è Filter</h2>
        <p class="info-text">The filter removes certain frequencies, shaping the timbre of the sound.</p>
        <div class="controls-grid">
          <div class="control-group">
            <span class="control-label">Cutoff</span>
            <div class="knob-container">
              <div class="knob" data-param="cutoff">
                <div class="knob-indicator"></div>
              </div>
            </div>
            <span class="value-display" id="cutoff-value">2000 Hz</span>
          </div>
          <div class="control-group">
            <span class="control-label">Resonance</span>
            <div class="knob-container">
              <div class="knob" data-param="resonance">
                <div class="knob-indicator"></div>
              </div>
            </div>
            <span class="value-display" id="resonance-value">1</span>
          </div>
        </div>
      </div>

      <!-- LFO Section -->
      <div class="section">
        <h2>üîÑ LFO Modulation</h2>
        <p class="info-text">Modulate the filter cutoff with a low-frequency oscillator.</p>
        <div class="waveform-select">
          <button class="lfo-btn active" data-lfo-wave="sine">Sine</button>
          <button class="lfo-btn" data-lfo-wave="square">Square</button>
          <button class="lfo-btn" data-lfo-wave="sawtooth">Sawtooth</button>
          <button class="lfo-btn" data-lfo-wave="triangle">Triangle</button>
        </div>
        <div class="controls-grid">
          <div class="control-group">
            <span class="control-label">Rate</span>
            <div class="knob-container">
              <div class="knob" data-param="lfo-rate">
                <div class="knob-indicator"></div>
              </div>
            </div>
            <span class="value-display" id="lfo-rate-value">2 Hz</span>
          </div>
          <div class="control-group">
            <span class="control-label">Depth</span>
            <div class="knob-container">
              <div class="knob" data-param="lfo-depth">
                <div class="knob-indicator"></div>
              </div>
            </div>
            <span class="value-display" id="lfo-depth-value">500</span>
          </div>
        </div>
      </div>

      <!-- ADSR Envelope -->
      <div class="section">
        <h2>üìà ADSR Envelope</h2>
        <p class="info-text">Controls how the sound evolves over time.</p>
        <canvas id="adsr-canvas" width="600" height="150" style="width: 100%; height: 150px; margin-bottom: 1rem; border-radius: 8px;"></canvas>
        <div class="controls-grid">
          <div class="control-group">
            <span class="control-label">Attack</span>
            <div class="knob-container">
              <div class="knob" data-param="attack">
                <div class="knob-indicator"></div>
              </div>
            </div>
            <span class="value-display" id="attack-value">0.01s</span>
          </div>
          <div class="control-group">
            <span class="control-label">Decay</span>
            <div class="knob-container">
              <div class="knob" data-param="decay">
                <div class="knob-indicator"></div>
              </div>
            </div>
            <span class="value-display" id="decay-value">0.2s</span>
          </div>
          <div class="control-group">
            <span class="control-label">Sustain</span>
            <div class="knob-container">
              <div class="knob" data-param="sustain">
                <div class="knob-indicator"></div>
              </div>
            </div>
            <span class="value-display" id="sustain-value">0.5</span>
          </div>
          <div class="control-group">
            <span class="control-label">Release</span>
            <div class="knob-container">
              <div class="knob" data-param="release">
                <div class="knob-indicator"></div>
              </div>
            </div>
            <span class="value-display" id="release-value">0.8s</span>
          </div>
        </div>
      </div>

      <!-- Oscilloscope -->
      <div class="section">
        <h2>üìä Oscilloscope</h2>
        <p class="info-text">Visualize your waveform in real time.</p>
        <canvas id="oscilloscope" width="800" height="200" style="width: 100%; height: 200px;"></canvas>
      </div>
    </div>

    <!-- Virtual Keyboard -->
    <div class="keyboard">
      <div class="key" data-note="C4">C</div>
      <div class="key black" data-note="C#4">C#</div>
      <div class="key" data-note="D4">D</div>
      <div class="key black" data-note="D#4">D#</div>
      <div class="key" data-note="E4">E</div>
      <div class="key" data-note="F4">F</div>
      <div class="key black" data-note="F#4">F#</div>
      <div class="key" data-note="G4">G</div>
      <div class="key black" data-note="G#4">G#</div>
      <div class="key" data-note="A4">A</div>
      <div class="key black" data-note="A#4">A#</div>
      <div class="key" data-note="B4">B</div>
      <div class="key" data-note="C5">C</div>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    const synthParams = {
      waveform: 'sine',
      attack: 0.01,
      decay: 0.2,
      sustain: 0.5,
      release: 0.8,
      cutoff: 2000,
      resonance: 1,
      lfoWave: 'sine',
      lfoRate: 2,
      lfoDepth: 500
    };

    const lfo = new Tone.LFO({
      frequency: synthParams.lfoRate,
      type: synthParams.lfoWave,
      min: synthParams.cutoff - synthParams.lfoDepth,
      max: synthParams.cutoff + synthParams.lfoDepth
    }).start();

    const filter = new Tone.Filter({
      frequency: synthParams.cutoff,
      Q: synthParams.resonance
    }).toDestination();

    lfo.connect(filter.frequency);

    const synth = new Tone.Synth({
      oscillator: { type: synthParams.waveform },
      envelope: {
        attack: synthParams.attack,
        decay: synthParams.decay,
        sustain: synthParams.sustain,
        release: synthParams.release
      }
    }).connect(filter);

    // Oscilloscope setup
    const waveform = new Tone.Waveform(512);
    synth.connect(waveform);
    const oscCanvas = document.getElementById('oscilloscope');
    const oscCtx = oscCanvas.getContext('2d');

    function drawOscilloscope() {
      requestAnimationFrame(drawOscilloscope);
      const values = waveform.getValue();
      const width = oscCanvas.width;
      const height = oscCanvas.height;
      oscCtx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--bg-primary');
      oscCtx.fillRect(0, 0, width, height);
      oscCtx.beginPath();
      oscCtx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--accent-color');
      oscCtx.lineWidth = 2;
      const sliceWidth = width / values.length;
      let x = 0;
      for (let i = 0; i < values.length; i++) {
        const v = (values[i] + 1) / 2;
        const y = v * height;
        if (i === 0) oscCtx.moveTo(x, y);
        else oscCtx.lineTo(x, y);
        x += sliceWidth;
      }
      oscCtx.stroke();
    }
    drawOscilloscope();

    // Theme toggle
    const themeToggle = document.getElementById('theme-toggle');
    if (localStorage.getItem('theme') === 'light') {
      document.body.classList.add('light-theme');
      themeToggle.checked = true;
    }
    themeToggle.addEventListener('change', () => {
      const isLight = themeToggle.checked;
      document.body.classList.toggle('light-theme', isLight);
      localStorage.setItem('theme', isLight ? 'light' : 'dark');
    });

    // Waveform select
    document.querySelectorAll('.wave-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.wave-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        synth.oscillator.type = btn.dataset.wave;
      });
    });

    // LFO wave select
    document.querySelectorAll('.lfo-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.lfo-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        lfo.type = btn.dataset.lfoWave;
      });
    });

    // Knob system
    class Knob {
      constructor(element, param, min, max, value, callback) {
        this.el = element;
        this.param = param;
        this.min = min;
        this.max = max;
        this.value = value;
        this.callback = callback;
        this.indicator = this.el.querySelector('.knob-indicator');
        this.isDragging = false;
        this.el.addEventListener('mousedown', this.startDrag.bind(this));
        document.addEventListener('mousemove', this.drag.bind(this));
        document.addEventListener('mouseup', this.endDrag.bind(this));
        this.update();
      }
      startDrag(e) {
        this.isDragging = true;
        this.startY = e.clientY;
        this.startVal = this.value;
        e.preventDefault();
      }
      drag(e) {
        if (!this.isDragging) return;
        const delta = (this.startY - e.clientY) / 100 * (this.max - this.min);
        this.value = Math.min(this.max, Math.max(this.min, this.startVal + delta));
        this.update();
        this.callback(this.value);
      }
      endDrag() { this.isDragging = false; }
      update() {
        const pct = (this.value - this.min) / (this.max - this.min);
        const rot = -135 + pct * 270;
        this.indicator.style.transform = `translateX(-50%) rotate(${rot}deg)`;
      }
    }

    // Init knobs
    new Knob(document.querySelector('[data-param="cutoff"]'), 'cutoff', 100, 5000, synthParams.cutoff, val => {
      filter.frequency.value = val;
      document.getElementById('cutoff-value').textContent = `${Math.round(val)} Hz`;
    });
    new Knob(document.querySelector('[data-param="resonance"]'), 'resonance', 0.1, 20, synthParams.resonance, val => {
      filter.Q.value = val;
      document.getElementById('resonance-value').textContent = val.toFixed(1);
    });
    new Knob(document.querySelector('[data-param="lfo-rate"]'), 'lfo-rate', 0.1, 10, synthParams.lfoRate, val => {
      lfo.frequency.value = val;
      document.getElementById('lfo-rate-value').textContent = `${val.toFixed(1)} Hz`;
    });
    new Knob(document.querySelector('[data-param="lfo-depth"]'), 'lfo-depth', 0, 2000, synthParams.lfoDepth, val => {
      lfo.min = synthParams.cutoff - val;
      lfo.max = synthParams.cutoff + val;
      document.getElementById('lfo-depth-value').textContent = Math.round(val);
    });
    new Knob(document.querySelector('[data-param="attack"]'), 'attack', 0.001, 2, synthParams.attack, val => {
      synth.envelope.attack = val;
      document.getElementById('attack-value').textContent = `${val.toFixed(2)}s`;
    });
    new Knob(document.querySelector('[data-param="decay"]'), 'decay', 0.001, 2, synthParams.decay, val => {
      synth.envelope.decay = val;
      document.getElementById('decay-value').textContent = `${val.toFixed(2)}s`;
    });
    new Knob(document.querySelector('[data-param="sustain"]'), 'sustain', 0, 1, synthParams.sustain, val => {
      synth.envelope.sustain = val;
      document.getElementById('sustain-value').textContent = val.toFixed(2);
    });
    new Knob(document.querySelector('[data-param="release"]'), 'release', 0.001, 5, synthParams.release, val => {
      synth.envelope.release = val;
      document.getElementById('release-value').textContent = `${val.toFixed(2)}s`;
    });

    // Keyboard play
    document.querySelectorAll('.key').forEach(key => {
      const note = key.dataset.note;
      key.addEventListener('mousedown', async () => {
        await Tone.start();
        synth.triggerAttack(note);
        key.classList.add('active');
      });
      key.addEventListener('mouseup', () => {
        synth.triggerRelease();
        key.classList.remove('active');
      });
      key.addEventListener('mouseleave', () => {
        synth.triggerRelease();
        key.classList.remove('active');
      });
    });
  </script>
</body>
</html>
